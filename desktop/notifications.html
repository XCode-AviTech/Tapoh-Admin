<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="../assets/images/logo.png" type="image/x-icon">
  <title>Notifications | Tapoh Fc</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="../assets/css/admin.css">
  <link rel="stylesheet" href="../assets/css/orient.css">
  
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar p-3" id="sidebar">

    <div class="logo">
      <img src="../assets/images/logo.png" alt="">
      <div class="info">
        <h4>Tapoh Fc</h4>
        <p>Content Mgt Panel</p>
      </div>
    </div>

    <hr>
    
    <ul class="nav flex-column">
      <li class="nav-item">
        <a href="./index.html" class="nav-link">
          <i class="bi bi-speedometer2"></i>
          <span>Dashboard</span>
        </a>
      </li>
      
      <li class="nav-item">
        <a href="./mgt.html" class="nav-link">
          <i class="bi bi-briefcase"></i>
          <span>Management</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="./shop.html" class="nav-link">
          <i class="bi bi-cart"></i>
          <span>Merchandise</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="./news.html" class="nav-link">
          <i class="bi bi-newspaper"></i>
          <span>News</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="./players.html" class="nav-link">
          <i class="bi bi-people"></i>
          <span>Players</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="./match.html" class="nav-link">
          <i class="bi bi-calendar-event"></i>
          <span> Matches</span>
        </a>
      </li>

      <li class="nav-item">
       <a href="./scores.html" class="nav-link">
          <i class="bi bi-trophy"></i>
          <span>Game Results</span>
        </a>
      </li> 

      <li class="nav-item">
        <a href="./gallery.html" class="nav-link">
          <i class="bi bi-upload"></i>
          <span>Gallery Uploads</span>
        </a>
      </li>
      
      <li class="nav-item">
        <a href="./review.html" class="nav-link">
          <i class="bi bi-stars"></i>
          <span>Team Reviews</span>
        </a>
      </li>

    </ul>
    
    <hr class="foot">
    
    <footer>
      <p>Tapoh FC &copy;<span id="year"></span></p>
      <p>Developed by <a href="" target="_blank" rel="noopener">X~Code</a></p>
    </footer>
  </div>

  <div class="content">
    
    <nav class="navbar navbar-expand-lg shadow-sm">
      <div class="container-fluid">
        <h5 class="banner">
          <i class="bi bi-bell"></i>
          <span>Notifications</span>
        </h5>
        <div class="right">
          <div class="notif">
            <a href="./notifications.html" title="Notifications">
              <i class="bi bi-bell-fill"></i>
            </a>
            <div class="notif-show"></div>
          </div>
          <div class="dropdown ms-auto">
            <a class="d-flex align-items-center dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
              <i class="bi bi-person-circle"></i>
              <span>Admin</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end">
              <li>
                <a class="dropdown-item" href="./settings.html#profile">
                  <i class="bi bi-person-fill"></i>
                  <span>Profile</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item" href="./settings.html">
                  <i class="bi bi-gear-fill"></i>
                  <span>Settings</span>
                </a>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item" href="../assets/php/logout.php">
                  <i class="bi bi-door-open"></i>
                  <span>Logout</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- Critical Alerts -->
    <div class="container-fluid mt-4">
      <div class="alert alert-danger d-flex align-items-center" role="alert">
        <div><i class="bi bi-exclamation-triangle-fill me-2"></i>Security Alert: Multiple failed login attempts detected from IP <strong>192.168.1.24</strong></div>
      </div>
    </div>

    <!-- Notifications Table -->
    <div class="container-fluid mt-3 tbl">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <i class="bi bi-bell-fill"></i> Recent System Notifications
        </div>
        <div class="card-body table-responsive">
          <table id="notifTable" class="table-striped table-bordered">
            <thead>
              <tr>
                <th>#</th>
                <th>Message</th>
                <th>Type</th>
                <th>Date</th>
                <th>IP / User</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Admin login detected.</td>
                <td><span class="badge bg-info">Login</span></td>
                <td>2025-10-02</td>
                <td>192.168.1.10 / Admin</td>
                <td><span class="badge bg-warning">Unread</span></td>
                <td class="buttons">
                  <button class="btn btn-success btn-sm" title="Mark as read"><i class="bi bi-eye"></i></button>
                  <button class="btn btn-danger btn-sm" title="Delete"><i class="bi bi-trash"></i></button>
                </td>
              </tr>
              <tr>
                <td>2</td>
                <td>New review posted on Team page.</td>
                <td><span class="badge bg-success">Review</span></td>
                <td>2025-09-30</td>
                <td>User: fan123</td>
                <td><span class="badge bg-warning">Unread</span></td>
                <td class="buttons">
                  <button class="btn btn-success btn-sm" title="Mark as read"><i class="bi bi-eye"></i></button>
                  <button class="btn btn-danger btn-sm" title="Delete"><i class="bi bi-trash"></i></button>
                </td>
              </tr>
              <tr>
                <td>3</td>
                <td>News article updated by Editor.</td>
                <td><span class="badge bg-primary">Edit</span></td>
                <td>2025-09-29</td>
                <td>Editor1</td>
                <td><span class="badge bg-warning">Unread</span></td>
                <td class="buttons">
                  <button class="btn btn-success btn-sm" title="Mark as read"><i class="bi bi-eye"></i></button>
                  <button class="btn btn-danger btn-sm" title="Delete"><i class="bi bi-trash"></i></button>
                </td>
              </tr>
              <tr>
                <td>4</td>
                <td>System performance: CPU usage exceeded 85%.</td>
                <td><span class="badge bg-danger">System</span></td>
                <td>2025-09-25</td>
                <td>Server</td>
                <td><span class="badge bg-warning">Unread</span></td>
                <td class="buttons">
                  <button class="btn btn-success btn-sm" title="Mark as read"><i class="bi bi-eye"></i></button>
                  <button class="btn btn-danger btn-sm" title="Delete"><i class="bi bi-trash"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
  <script src="../assets/js/redirect.js"></script>
  <script>
$(document).ready(function () {
    let notifTable = $('#notifTable').DataTable({
        lengthMenu: [5, 10, 25, 50, 100], // Entry selector options
      pageLength: 5,
        lengthChange: true,
        ordering: true,
        searching: false,
        info: true,
        pagingType: "simple_numbers",
        language: {
            info: "Showing _START_ to _END_ of _TOTAL_ notifications"
        }
    });

    // --- Mark as Read ---
    $(document).on("click", ".btn-success", function () {
        let row = $(this).closest("tr");
        let statusCell = row.find("td:eq(5) span");
        let btn = $(this);

        // Only mark if currently unread
        if (statusCell.text().trim() === "Unread") {
            // Change badge to "Read"
            statusCell.removeClass("bg-warning").addClass("bg-secondary").text("Read");

            // Change button to show blue double ticks and disable it
            btn.html('<i class="bi bi-check2-all text-primary"></i> <span>Read</span>');
            btn.prop("disabled", true).removeClass("btn-success").addClass("btn-outline-secondary");
        }
    });


    // --- Delete Notification ---
    let deleteRow;
    $(document).on("click", ".btn-danger", function () {
        deleteRow = $(this).closest("tr");
        let message = deleteRow.find("td:eq(1)").text();

        // Create a simple confirmation modal dynamically
        let modalHtml = `
        <div class="modal fade" id="deleteNotifModal" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">Delete Notification</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                Are you sure you want to delete this notification? <br><strong>${message}</strong>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteNotif">Delete</button>
              </div>
            </div>
          </div>
        </div>`;
        $("body").append(modalHtml);
        let deleteModal = new bootstrap.Modal($("#deleteNotifModal"));
        deleteModal.show();

        // Confirm deletion
        $(document).on("click", "#confirmDeleteNotif", function () {
            if (deleteRow) {
                notifTable.row(deleteRow).remove().draw();
                deleteModal.hide();
                $("#deleteNotifModal").remove();
            }
        });

        // Remove modal from DOM on hide
        $('#deleteNotifModal').on('hidden.bs.modal', function () {
            $(this).remove();
        });
    });
});
</script>

</body>
</html>
